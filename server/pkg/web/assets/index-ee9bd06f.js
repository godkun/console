var to=Object.defineProperty;var no=(y,_,a)=>_ in y?to(y,_,{enumerable:!0,configurable:!0,writable:!0,value:a}):y[_]=a;var F=(y,_,a)=>(no(y,typeof _!="symbol"?_+"":_,a),a);import{_ as nt}from"./index-19bd79aa.js";import{h as oo,o as io}from"./vendor-1e70d1e5.js";import{u as ao}from"./pluginConfig-9977edb4.js";import{e as so,O as uo,C as x,F as ne,I as or,W as co,D as lo,a as fo}from"./webrtc-b8715042.js";import"./index-44f2928b.js";const ho={class:"container"},po=["srcObject"],vo={class:"title"},mo=Vue.defineComponent({__name:"video",props:{value:null},setup(y){const _=y,a=Vue.ref(),d=new MediaStream;return Vue.watchEffect(()=>{_.value.audioTrack&&d.getAudioTracks().length==0&&d.addTrack(_.value.audioTrack),_.value.videoTrack&&d.getVideoTracks().length==0&&d.addTrack(_.value.videoTrack),(_.value.audioTrack||_.value.videoTrack)&&a.value&&a.value.play()}),(p,b)=>(Vue.openBlock(),Vue.createElementBlock("div",ho,[Vue.createElementVNode("video",{ref_key:"videoEle",ref:a,srcObject:Vue.unref(d),autoplay:""},null,8,po),Vue.createElementVNode("div",vo,Vue.toDisplayString(y.value.id),1)]))}}),go=nt(mo,[["__scopeId","data-v-526acf65"]]);var je=(y=>(y.AUDIO_ENCODER_CONFIG_CHANGED="audio-encoder-config-changed",y.VIDEO_ENCODER_CONFIG_CHANGED="video-encoder-config-changed",y))(je||{}),Ne=(y=>(y[y.PULL=0]="PULL",y[y.PUSH=1]="PUSH",y))(Ne||{});class yo extends so.EventEmitter{constructor(a,d=0){super();F(this,"audioReadable");F(this,"videoReadable");F(this,"audioDecoderConfig");F(this,"videoDecoderConfig");F(this,"gotAudio");F(this,"gotVideo");this.source=a,this.mode=d,console.log("Demuxer Created:",Object.getPrototypeOf(this).constructor.name),a&&(d==0?this.startPull(a):a.oput=new uo(this.demux()))}startPull(a){this.mode=0,this.source=a,this.audioReadable=new ReadableStream({pull:async d=>d.enqueue(await this.pullAudio())}),this.videoReadable=new ReadableStream({pull:async d=>d.enqueue(await this.pullVideo())})}pullAudio(){return new Promise((a,d)=>{this.gotAudio=a,this.gotVideo&&this.pull().catch(d)})}pullVideo(){return new Promise((a,d)=>{this.gotVideo=a,this.gotAudio&&this.pull().catch(d)})}}const wo=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350,-1,-1,-1];class _o extends yo{constructor(){super(...arguments);F(this,"header");F(this,"tmp8",new Uint8Array(4));F(this,"dv",new DataView(this.tmp8.buffer))}async pullTag(){const a=new Uint8Array(15);return this.pullTag=async()=>{await this.source.read(a);const d=a[4],p=this.readLength(a.subarray(5,8)),b=this.readTimestamp(a.subarray(8,11)),k=await this.source.read(p);return{type:d,data:k.slice(),timestamp:b}},console.time("flv"),await this.source.read(9).then(d=>{if(this.header=d,console.log(d),d[0]!="F".charCodeAt(0)||d[1]!="L".charCodeAt(0)||d[2]!="V".charCodeAt(0))throw new Error("not flv");console.timeEnd("flv")}),this.pullTag()}readTag(a){const d=a[0],p=this.readLength(a.subarray(1,4)),b=this.readTimestamp(a.subarray(4,8));this.gotTag(d,a.subarray(11,11+p),b)}gotTag(a,d,p){var b,k;switch(a){case 8:return this.audioDecoderConfig||(this.audioDecoderConfig={codec:{10:"aac",7:"pcma",8:"pcmu"}[d[0]>>4]||"unknown",numberOfChannels:1,sampleRate:8e3},this.audioDecoderConfig.codec=="aac"&&(this.audioDecoderConfig.numberOfChannels=d[3]>>3&15,this.audioDecoderConfig.sampleRate=wo[(d[2]&7)<<1|d[3]>>7])),this.audioDecoderConfig.codec=="aac"&&d[1]==0?(this.audioDecoderConfig.description=d.subarray(2),this.emit(je.AUDIO_ENCODER_CONFIG_CHANGED,this.audioDecoderConfig),this.mode==Ne.PULL?this.pull():void 0):(b=this.gotAudio)==null?void 0:b.call(this,{type:"key",data:this.audioDecoderConfig.codec=="aac"?d.subarray(2):d.subarray(1),timestamp:p,duration:0});case 9:return this.videoDecoderConfig||(this.videoDecoderConfig={codec:{7:"avc",12:"hevc"}[d[0]&15]||"unknown",description:d.subarray(5)}),d[1]==0?(this.emit(je.VIDEO_ENCODER_CONFIG_CHANGED,this.videoDecoderConfig),this.mode==Ne.PULL?this.pull():void 0):(k=this.gotVideo)==null?void 0:k.call(this,{type:d[0]>>4==1?"key":"delta",data:d.subarray(5),timestamp:p,duration:0});default:if(this.mode==Ne.PULL)return this.pull()}}async pull(){const a=await this.pullTag();if(a)return this.gotTag(a.type,a.data,a.timestamp)}readLength(a){return this.tmp8[0]=0,this.tmp8.set(a,1),this.dv.getUint32(0)}readTimestamp(a){this.tmp8.set(a.subarray(0,3),1);let d=this.dv.getUint32(0);return d===16777215&&(this.tmp8[0]=a[3],d=this.dv.getUint32(0)),d}readHead(a){if(console.time("flv"),this.header=a,console.log(a),a[0]!="F".charCodeAt(0)||a[1]!="L".charCodeAt(0)||a[2]!="V".charCodeAt(0))throw new Error("not flv");console.timeEnd("flv")}*demux(){for(this.readHead(yield 13);;){let a=yield 11;const d=a[0],p=this.readLength(a.subarray(1,4)),b=this.readTimestamp(a.subarray(4,8));a=yield p,this.gotTag(d,a.slice(),b),yield 4}}}var ve=(y=>(y.VideoCodecInfo="videoCodecInfo",y.VideoFrame="videoFrame",y.Error="error",y))(ve||{}),me=(y=>(y.AudioCodecInfo="audioCodecInfo",y.AudioFrame="audioFrame",y.Error="error",y))(me||{}),Eo=Object.defineProperty,bo=Object.getOwnPropertyDescriptor,Ue=(y,_,a,d)=>{for(var p=d>1?void 0:d?bo(_,a):_,b=y.length-1,k;b>=0;b--)(k=y[b])&&(p=(d?k(_,a,p):k(p))||p);return d&&p&&Eo(_,a,p),p};class Ve extends ne{constructor(a){super();F(this,"decoder");F(this,"config");F(this,"module",{});F(this,"createModule");F(this,"width");F(this,"height");this.width=0,this.height=0,this.createModule=a}initialize(){return new Promise(a=>{const d=this.module;d.print=p=>console.log(p),d.printErr=p=>console.log(`[JS] ERROR: ${p}`),d.onAbort=()=>console.log("[JS] FATAL: WASM ABORTED"),d.postRun=p=>{this.decoder=new this.module.VideoDecoder(this),console.log("video soft decoder initialize success"),a()},this.createModule(d)})}configure(a){this.config=a,this.decoder.setCodec(this.config.codec,this.config.description?"avcc":"annexb",this.config.description??"")}decode(a){this.decoder.decode(a.data,a.type=="key",a.timestamp)}flush(){}reset(){this.config=void 0,this.decoder&&this.decoder.clear()}close(){this.removeAllListeners(),this.decoder&&(this.decoder.clear(),this.decoder.delete())}videoInfo(a,d){this.width=a,this.height=d;let p={width:a,height:d};this.emit(ve.VideoCodecInfo,p)}yuvData(a,d){if(!this.module)return;const p=this.width*this.height,b=p>>2;let k=this.module.HEAPU32[a>>2],J=this.module.HEAPU32[(a>>2)+1],V=this.module.HEAPU32[(a>>2)+2],ie=this.module.HEAPU8.subarray(k,k+p),R=this.module.HEAPU8.subarray(J,J+b),Z=this.module.HEAPU8.subarray(V,V+b);const ee=new Uint8Array(p+b+b);ee.set(ie),ee.set(R,p),ee.set(Z,p+b),this.emit(ve.VideoFrame,new VideoFrame(ee,{codedWidth:this.width,codedHeight:this.height,format:"I420",timestamp:d}))}errorInfo(a){let d={errMsg:a};this.emit(ve.Error,d)}}Ue([x([ne.INIT,"closed"],"initialized")],Ve.prototype,"initialize",1);Ue([x("initialized","configured")],Ve.prototype,"configure",1);Ue([or("configured")],Ve.prototype,"decode",1);Ue([x([],ne.INIT)],Ve.prototype,"reset",1);Ue([x([],"closed")],Ve.prototype,"close",1);var Po=Object.defineProperty,ko=Object.getOwnPropertyDescriptor,ze=(y,_,a,d)=>{for(var p=d>1?void 0:d?ko(_,a):_,b=y.length-1,k;b>=0;b--)(k=y[b])&&(p=(d?k(_,a,p):k(p))||p);return d&&p&&Po(_,a,p),p};class Te extends ne{constructor(){super(...arguments);F(this,"decoder");F(this,"config")}async initialize(){this.decoder=new VideoDecoder({output:a=>{this.emit(ve.VideoFrame,a)},error:a=>{this.emit(ve.Error,a),this.close()}})}configure(a){this.config=a,console.log("configure",a),this.decoder.configure({...a,codec:a.codec=="hevc"?"hvc1.1.6.L0.12.34.56.78.9A.BC":"avc1.420028"})}decode(a){this.decoder.state==="configured"&&this.decoder.decode(new EncodedVideoChunk(a))}flush(){this.decoder.flush()}reset(){this.decoder.reset()}close(){this.decoder.close()}}ze([x([ne.INIT,"closed"],"initialized")],Te.prototype,"initialize",1);ze([x("initialized","configured")],Te.prototype,"configure",1);ze([or("configured")],Te.prototype,"decode",1);ze([x([],ne.INIT)],Te.prototype,"reset",1);ze([x([],"closed",{ignoreError:!0})],Te.prototype,"close",1);var Co=(()=>{var y=import.meta.url;return function(a){a=a||{};var a=typeof a<"u"?a:{},d,p;a.ready=new Promise(function(e,r){d=e,p=r});var b=Object.assign({},a),k="./this.program",J=typeof window=="object",V=typeof importScripts=="function",ie=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",R="";function Z(e){return a.locateFile?a.locateFile(e,R):R+e}var ee,W,S,z,te,B;ie?(V?R=require("path").dirname(R)+"/":R=__dirname+"/",B=()=>{te||(z=require("fs"),te=require("path"))},ee=function(r,t){return B(),r=te.normalize(r),z.readFileSync(r,t?void 0:"utf8")},S=e=>{var r=ee(e,!0);return r.buffer||(r=new Uint8Array(r)),r},W=(e,r,t)=>{B(),e=te.normalize(e),z.readFile(e,function(n,i){n?t(n):r(i.buffer)})},process.argv.length>1&&(k=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof ro))throw e}),process.on("unhandledRejection",function(e){throw e}),a.inspect=function(){return"[Emscripten Module object]"}):(J||V)&&(V?R=self.location.href:typeof document<"u"&&document.currentScript&&(R=document.currentScript.src),y&&(R=y),R.indexOf("blob:")!==0?R=R.substr(0,R.replace(/[?#].*/,"").lastIndexOf("/")+1):R="",ee=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(null),r.responseText},V&&(S=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),W=(e,r,t)=>{var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=()=>{if(n.status==200||n.status==0&&n.response){r(n.response);return}t()},n.onerror=t,n.send(null)});var M=a.print||console.log.bind(console),G=a.printErr||console.warn.bind(console);Object.assign(a,b),b=null,a.arguments&&a.arguments,a.thisProgram&&(k=a.thisProgram),a.quit&&a.quit;var de=4,re;a.wasmBinary&&(re=a.wasmBinary),a.noExitRuntime,typeof WebAssembly!="object"&&we("no native wasm support detected");var O,he=!1;function kr(e,r){e||we(r)}var Cr=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Pe(e,r,t){for(var n=r+t,i=r;e[i]&&!(i>=n);)++i;if(i-r>16&&e.buffer&&Cr)return Cr.decode(e.subarray(r,i));for(var s="";r<i;){var c=e[r++];if(!(c&128)){s+=String.fromCharCode(c);continue}var u=e[r++]&63;if((c&224)==192){s+=String.fromCharCode((c&31)<<6|u);continue}var l=e[r++]&63;if((c&240)==224?c=(c&15)<<12|u<<6|l:c=(c&7)<<18|u<<12|l<<6|e[r++]&63,c<65536)s+=String.fromCharCode(c);else{var f=c-65536;s+=String.fromCharCode(55296|f>>10,56320|f&1023)}}return s}function Dr(e,r){return e?Pe(L,e,r):""}function ir(e,r,t,n){if(!(n>0))return 0;for(var i=t,s=t+n-1,c=0;c<e.length;++c){var u=e.charCodeAt(c);if(u>=55296&&u<=57343){var l=e.charCodeAt(++c);u=65536+((u&1023)<<10)|l&1023}if(u<=127){if(t>=s)break;r[t++]=u}else if(u<=2047){if(t+1>=s)break;r[t++]=192|u>>6,r[t++]=128|u&63}else if(u<=65535){if(t+2>=s)break;r[t++]=224|u>>12,r[t++]=128|u>>6&63,r[t++]=128|u&63}else{if(t+3>=s)break;r[t++]=240|u>>18,r[t++]=128|u>>12&63,r[t++]=128|u>>6&63,r[t++]=128|u&63}}return r[t]=0,t-i}function ot(e,r,t){return ir(e,L,r,t)}function ar(e){for(var r=0,t=0;t<e.length;++t){var n=e.charCodeAt(t);n>=55296&&n<=57343&&(n=65536+((n&1023)<<10)|e.charCodeAt(++t)&1023),n<=127?++r:n<=2047?r+=2:n<=65535?r+=3:r+=4}return r}var Tr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function it(e,r){for(var t=e,n=t>>1,i=n+r/2;!(n>=i)&&xe[n];)++n;if(t=n<<1,t-e>32&&Tr)return Tr.decode(L.subarray(e,t));for(var s="",c=0;!(c>=r/2);++c){var u=ge[e+c*2>>1];if(u==0)break;s+=String.fromCharCode(u)}return s}function at(e,r,t){if(t===void 0&&(t=2147483647),t<2)return 0;t-=2;for(var n=r,i=t<e.length*2?t/2:e.length,s=0;s<i;++s){var c=e.charCodeAt(s);ge[r>>1]=c,r+=2}return ge[r>>1]=0,r-n}function st(e){return e.length*2}function ut(e,r){for(var t=0,n="";!(t>=r/4);){var i=P[e+t*4>>2];if(i==0)break;if(++t,i>=65536){var s=i-65536;n+=String.fromCharCode(55296|s>>10,56320|s&1023)}else n+=String.fromCharCode(i)}return n}function ct(e,r,t){if(t===void 0&&(t=2147483647),t<4)return 0;for(var n=r,i=n+t-4,s=0;s<e.length;++s){var c=e.charCodeAt(s);if(c>=55296&&c<=57343){var u=e.charCodeAt(++s);c=65536+((c&1023)<<10)|u&1023}if(P[r>>2]=c,r+=4,r+4>i)break}return P[r>>2]=0,r-n}function lt(e){for(var r=0,t=0;t<e.length;++t){var n=e.charCodeAt(t);n>=55296&&n<=57343&&++t,r+=4}return r}function ft(e,r,t){for(var n=0;n<e.length;++n)K[r++>>0]=e.charCodeAt(n);t||(K[r>>0]=0)}var sr,K,L,ge,xe,P,A,Ar,Fr;function dt(e){sr=e,a.HEAP8=K=new Int8Array(e),a.HEAP16=ge=new Int16Array(e),a.HEAP32=P=new Int32Array(e),a.HEAPU8=L=new Uint8Array(e),a.HEAPU16=xe=new Uint16Array(e),a.HEAPU32=A=new Uint32Array(e),a.HEAPF32=Ar=new Float32Array(e),a.HEAPF64=Fr=new Float64Array(e)}a.INITIAL_MEMORY;var Sr,Rr=[],Or=[],$r=[];function ht(){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;)mt(a.preRun.shift());cr(Rr)}function pt(){!a.noFSInit&&!o.init.initialized&&o.init(),o.ignorePermissions=!1,cr(Or)}function vt(){if(a.postRun)for(typeof a.postRun=="function"&&(a.postRun=[a.postRun]);a.postRun.length;)yt(a.postRun.shift());cr($r)}function mt(e){Rr.unshift(e)}function gt(e){Or.unshift(e)}function yt(e){$r.unshift(e)}var ye=0,Fe=null;function Io(e){return e}function ur(e){ye++,a.monitorRunDependencies&&a.monitorRunDependencies(ye)}function We(e){if(ye--,a.monitorRunDependencies&&a.monitorRunDependencies(ye),ye==0&&Fe){var r=Fe;Fe=null,r()}}function we(e){a.onAbort&&a.onAbort(e),e="Aborted("+e+")",G(e),he=!0,e+=". Build with -sASSERTIONS for more info.";var r=new WebAssembly.RuntimeError(e);throw p(r),r}var wt="data:application/octet-stream;base64,";function Ir(e){return e.startsWith(wt)}function Mr(e){return e.startsWith("file://")}var q;a.locateFile?(q="audiodec.wasm",Ir(q)||(q=Z(q))):q=new URL(""+new URL("audiodec-28b192dd.wasm",import.meta.url).href,self.location).toString();function Nr(e){try{if(e==q&&re)return new Uint8Array(re);if(S)return S(e);throw"both async and sync fetching of the wasm failed"}catch(r){we(r)}}function _t(){if(!re&&(J||V)){if(typeof fetch=="function"&&!Mr(q))return fetch(q,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+q+"'";return e.arrayBuffer()}).catch(function(){return Nr(q)});if(W)return new Promise(function(e,r){W(q,function(t){e(new Uint8Array(t))},r)})}return Promise.resolve().then(function(){return Nr(q)})}function Et(){var e={a:eo};function r(c,u){var l=c.exports;a.asm=l,O=a.asm.G,dt(O.buffer),Sr=a.asm.J,gt(a.asm.H),We()}ur();function t(c){r(c.instance)}function n(c){return _t().then(function(u){return WebAssembly.instantiate(u,e)}).then(function(u){return u}).then(c,function(u){G("failed to asynchronously prepare wasm: "+u),we(u)})}function i(){return!re&&typeof WebAssembly.instantiateStreaming=="function"&&!Ir(q)&&!Mr(q)&&!ie&&typeof fetch=="function"?fetch(q,{credentials:"same-origin"}).then(function(c){var u=WebAssembly.instantiateStreaming(c,e);return u.then(t,function(l){return G("wasm streaming compile failed: "+l),G("falling back to ArrayBuffer instantiation"),n(t)})}):n(t)}if(a.instantiateWasm)try{var s=a.instantiateWasm(e,r);return s}catch(c){return G("Module.instantiateWasm callback failed with error: "+c),!1}return i().catch(p),{}}var N,ae;function cr(e){for(;e.length>0;){var r=e.shift();if(typeof r=="function"){r(a);continue}var t=r.func;typeof t=="number"?r.arg===void 0?qe(t)():qe(t)(r.arg):t(r.arg===void 0?null:r.arg)}}var Ge=[];function qe(e){var r=Ge[e];return r||(e>=Ge.length&&(Ge.length=e+1),Ge[e]=r=Sr.get(e)),r}function bt(e){return tr(e+24)+24}function Pt(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(r){A[this.ptr+4>>2]=r},this.get_type=function(){return A[this.ptr+4>>2]},this.set_destructor=function(r){A[this.ptr+8>>2]=r},this.get_destructor=function(){return A[this.ptr+8>>2]},this.set_refcount=function(r){P[this.ptr>>2]=r},this.set_caught=function(r){r=r?1:0,K[this.ptr+12>>0]=r},this.get_caught=function(){return K[this.ptr+12>>0]!=0},this.set_rethrown=function(r){r=r?1:0,K[this.ptr+13>>0]=r},this.get_rethrown=function(){return K[this.ptr+13>>0]!=0},this.init=function(r,t){this.set_adjusted_ptr(0),this.set_type(r),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var r=P[this.ptr>>2];P[this.ptr>>2]=r+1},this.release_ref=function(){var r=P[this.ptr>>2];return P[this.ptr>>2]=r-1,r===1},this.set_adjusted_ptr=function(r){A[this.ptr+16>>2]=r},this.get_adjusted_ptr=function(){return A[this.ptr+16>>2]},this.get_exception_ptr=function(){var r=tt(this.get_type());if(r)return A[this.excPtr>>2];var t=this.get_adjusted_ptr();return t!==0?t:this.excPtr}}function kt(e,r,t){var n=new Pt(e);throw n.init(r,t),e}function Ct(e){return P[Zr()>>2]=e,e}var C={isAbs:e=>e.charAt(0)==="/",splitPath:e=>{var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return r.exec(e).slice(1)},normalizeArray:(e,r)=>{for(var t=0,n=e.length-1;n>=0;n--){var i=e[n];i==="."?e.splice(n,1):i===".."?(e.splice(n,1),t++):t&&(e.splice(n,1),t--)}if(r)for(;t;t--)e.unshift("..");return e},normalize:e=>{var r=C.isAbs(e),t=e.substr(-1)==="/";return e=C.normalizeArray(e.split("/").filter(n=>!!n),!r).join("/"),!e&&!r&&(e="."),e&&t&&(e+="/"),(r?"/":"")+e},dirname:e=>{var r=C.splitPath(e),t=r[0],n=r[1];return!t&&!n?".":(n&&(n=n.substr(0,n.length-1)),t+n)},basename:e=>{if(e==="/")return"/";e=C.normalize(e),e=e.replace(/\/$/,"");var r=e.lastIndexOf("/");return r===-1?e:e.substr(r+1)},join:function(){var e=Array.prototype.slice.call(arguments,0);return C.normalize(e.join("/"))},join2:(e,r)=>C.normalize(e+"/"+r)};function Dt(){if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function"){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}else if(ie)try{var r=require("crypto");return function(){return r.randomBytes(1)[0]}}catch{}return function(){we("randomDevice")}}var se={resolve:function(){for(var e="",r=!1,t=arguments.length-1;t>=-1&&!r;t--){var n=t>=0?arguments[t]:o.cwd();if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)return"";e=n+"/"+e,r=C.isAbs(n)}return e=C.normalizeArray(e.split("/").filter(i=>!!i),!r).join("/"),(r?"/":"")+e||"."},relative:(e,r)=>{e=se.resolve(e).substr(1),r=se.resolve(r).substr(1);function t(f){for(var v=0;v<f.length&&f[v]==="";v++);for(var m=f.length-1;m>=0&&f[m]==="";m--);return v>m?[]:f.slice(v,m-v+1)}for(var n=t(e.split("/")),i=t(r.split("/")),s=Math.min(n.length,i.length),c=s,u=0;u<s;u++)if(n[u]!==i[u]){c=u;break}for(var l=[],u=c;u<n.length;u++)l.push("..");return l=l.concat(i.slice(c)),l.join("/")}},_e={ttys:[],init:function(){},shutdown:function(){},register:function(e,r){_e.ttys[e]={input:[],output:[],ops:r},o.registerDevice(e,_e.stream_ops)},stream_ops:{open:function(e){var r=_e.ttys[e.node.rdev];if(!r)throw new o.ErrnoError(43);e.tty=r,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,r,t,n,i){if(!e.tty||!e.tty.ops.get_char)throw new o.ErrnoError(60);for(var s=0,c=0;c<n;c++){var u;try{u=e.tty.ops.get_char(e.tty)}catch{throw new o.ErrnoError(29)}if(u===void 0&&s===0)throw new o.ErrnoError(6);if(u==null)break;s++,r[t+c]=u}return s&&(e.node.timestamp=Date.now()),s},write:function(e,r,t,n,i){if(!e.tty||!e.tty.ops.put_char)throw new o.ErrnoError(60);try{for(var s=0;s<n;s++)e.tty.ops.put_char(e.tty,r[t+s])}catch{throw new o.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),s}},default_tty_ops:{get_char:function(e){if(!e.input.length){var r=null;if(ie){var t=256,n=Buffer.alloc(t),i=0;try{i=z.readSync(process.stdin.fd,n,0,t,-1)}catch(s){if(s.toString().includes("EOF"))i=0;else throw s}i>0?r=n.slice(0,i).toString("utf-8"):r=null}else typeof window<"u"&&typeof window.prompt=="function"?(r=window.prompt("Input: "),r!==null&&(r+=`
`)):typeof readline=="function"&&(r=readline(),r!==null&&(r+=`
`));if(!r)return null;e.input=br(r,!0)}return e.input.shift()},put_char:function(e,r){r===null||r===10?(M(Pe(e.output,0)),e.output=[]):r!=0&&e.output.push(r)},flush:function(e){e.output&&e.output.length>0&&(M(Pe(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,r){r===null||r===10?(G(Pe(e.output,0)),e.output=[]):r!=0&&e.output.push(r)},flush:function(e){e.output&&e.output.length>0&&(G(Pe(e.output,0)),e.output=[])}}};function Tt(e,r){L.fill(0,e,e+r)}function At(e,r){return Math.ceil(e/r)*r}function jr(e){e=At(e,65536);var r=rt(65536,e);return r?(Tt(r,e),r):0}var E={ops_table:null,mount:function(e){return E.createNode(null,"/",16895,0)},createNode:function(e,r,t,n){if(o.isBlkdev(t)||o.isFIFO(t))throw new o.ErrnoError(63);E.ops_table||(E.ops_table={dir:{node:{getattr:E.node_ops.getattr,setattr:E.node_ops.setattr,lookup:E.node_ops.lookup,mknod:E.node_ops.mknod,rename:E.node_ops.rename,unlink:E.node_ops.unlink,rmdir:E.node_ops.rmdir,readdir:E.node_ops.readdir,symlink:E.node_ops.symlink},stream:{llseek:E.stream_ops.llseek}},file:{node:{getattr:E.node_ops.getattr,setattr:E.node_ops.setattr},stream:{llseek:E.stream_ops.llseek,read:E.stream_ops.read,write:E.stream_ops.write,allocate:E.stream_ops.allocate,mmap:E.stream_ops.mmap,msync:E.stream_ops.msync}},link:{node:{getattr:E.node_ops.getattr,setattr:E.node_ops.setattr,readlink:E.node_ops.readlink},stream:{}},chrdev:{node:{getattr:E.node_ops.getattr,setattr:E.node_ops.setattr},stream:o.chrdev_stream_ops}});var i=o.createNode(e,r,t,n);return o.isDir(i.mode)?(i.node_ops=E.ops_table.dir.node,i.stream_ops=E.ops_table.dir.stream,i.contents={}):o.isFile(i.mode)?(i.node_ops=E.ops_table.file.node,i.stream_ops=E.ops_table.file.stream,i.usedBytes=0,i.contents=null):o.isLink(i.mode)?(i.node_ops=E.ops_table.link.node,i.stream_ops=E.ops_table.link.stream):o.isChrdev(i.mode)&&(i.node_ops=E.ops_table.chrdev.node,i.stream_ops=E.ops_table.chrdev.stream),i.timestamp=Date.now(),e&&(e.contents[r]=i,e.timestamp=i.timestamp),i},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,r){var t=e.contents?e.contents.length:0;if(!(t>=r)){var n=1024*1024;r=Math.max(r,t*(t<n?2:1.125)>>>0),t!=0&&(r=Math.max(r,256));var i=e.contents;e.contents=new Uint8Array(r),e.usedBytes>0&&e.contents.set(i.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,r){if(e.usedBytes!=r)if(r==0)e.contents=null,e.usedBytes=0;else{var t=e.contents;e.contents=new Uint8Array(r),t&&e.contents.set(t.subarray(0,Math.min(r,e.usedBytes))),e.usedBytes=r}},node_ops:{getattr:function(e){var r={};return r.dev=o.isChrdev(e.mode)?e.id:1,r.ino=e.id,r.mode=e.mode,r.nlink=1,r.uid=0,r.gid=0,r.rdev=e.rdev,o.isDir(e.mode)?r.size=4096:o.isFile(e.mode)?r.size=e.usedBytes:o.isLink(e.mode)?r.size=e.link.length:r.size=0,r.atime=new Date(e.timestamp),r.mtime=new Date(e.timestamp),r.ctime=new Date(e.timestamp),r.blksize=4096,r.blocks=Math.ceil(r.size/r.blksize),r},setattr:function(e,r){r.mode!==void 0&&(e.mode=r.mode),r.timestamp!==void 0&&(e.timestamp=r.timestamp),r.size!==void 0&&E.resizeFileStorage(e,r.size)},lookup:function(e,r){throw o.genericErrors[44]},mknod:function(e,r,t,n){return E.createNode(e,r,t,n)},rename:function(e,r,t){if(o.isDir(e.mode)){var n;try{n=o.lookupNode(r,t)}catch{}if(n)for(var i in n.contents)throw new o.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=t,r.contents[t]=e,r.timestamp=e.parent.timestamp,e.parent=r},unlink:function(e,r){delete e.contents[r],e.timestamp=Date.now()},rmdir:function(e,r){var t=o.lookupNode(e,r);for(var n in t.contents)throw new o.ErrnoError(55);delete e.contents[r],e.timestamp=Date.now()},readdir:function(e){var r=[".",".."];for(var t in e.contents)e.contents.hasOwnProperty(t)&&r.push(t);return r},symlink:function(e,r,t){var n=E.createNode(e,r,41471,0);return n.link=t,n},readlink:function(e){if(!o.isLink(e.mode))throw new o.ErrnoError(28);return e.link}},stream_ops:{read:function(e,r,t,n,i){var s=e.node.contents;if(i>=e.node.usedBytes)return 0;var c=Math.min(e.node.usedBytes-i,n);if(c>8&&s.subarray)r.set(s.subarray(i,i+c),t);else for(var u=0;u<c;u++)r[t+u]=s[i+u];return c},write:function(e,r,t,n,i,s){if(!n)return 0;var c=e.node;if(c.timestamp=Date.now(),r.subarray&&(!c.contents||c.contents.subarray)){if(s)return c.contents=r.subarray(t,t+n),c.usedBytes=n,n;if(c.usedBytes===0&&i===0)return c.contents=r.slice(t,t+n),c.usedBytes=n,n;if(i+n<=c.usedBytes)return c.contents.set(r.subarray(t,t+n),i),n}if(E.expandFileStorage(c,i+n),c.contents.subarray&&r.subarray)c.contents.set(r.subarray(t,t+n),i);else for(var u=0;u<n;u++)c.contents[i+u]=r[t+u];return c.usedBytes=Math.max(c.usedBytes,i+n),n},llseek:function(e,r,t){var n=r;if(t===1?n+=e.position:t===2&&o.isFile(e.node.mode)&&(n+=e.node.usedBytes),n<0)throw new o.ErrnoError(28);return n},allocate:function(e,r,t){E.expandFileStorage(e.node,r+t),e.node.usedBytes=Math.max(e.node.usedBytes,r+t)},mmap:function(e,r,t,n,i){if(!o.isFile(e.node.mode))throw new o.ErrnoError(43);var s,c,u=e.node.contents;if(!(i&2)&&u.buffer===sr)c=!1,s=u.byteOffset;else{if((t>0||t+r<u.length)&&(u.subarray?u=u.subarray(t,t+r):u=Array.prototype.slice.call(u,t,t+r)),c=!0,s=jr(r),!s)throw new o.ErrnoError(48);K.set(u,s)}return{ptr:s,allocated:c}},msync:function(e,r,t,n,i){if(!o.isFile(e.node.mode))throw new o.ErrnoError(43);return i&2||E.stream_ops.write(e,r,0,n,t,!1),0}}};function Ft(e,r,t,n){var i=n?"":"al "+e;W(e,function(s){kr(s,'Loading data file "'+e+'" failed (no arrayBuffer).'),r(new Uint8Array(s)),i&&We()},function(s){if(t)t();else throw'Loading data file "'+e+'" failed.'}),i&&ur()}var o={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:(e,r={})=>{if(e=se.resolve(o.cwd(),e),!e)return{path:"",node:null};var t={follow_mount:!0,recurse_count:0};if(r=Object.assign(t,r),r.recurse_count>8)throw new o.ErrnoError(32);for(var n=C.normalizeArray(e.split("/").filter(m=>!!m),!1),i=o.root,s="/",c=0;c<n.length;c++){var u=c===n.length-1;if(u&&r.parent)break;if(i=o.lookupNode(i,n[c]),s=C.join2(s,n[c]),o.isMountpoint(i)&&(!u||u&&r.follow_mount)&&(i=i.mounted.root),!u||r.follow)for(var l=0;o.isLink(i.mode);){var f=o.readlink(s);s=se.resolve(C.dirname(s),f);var v=o.lookupPath(s,{recurse_count:r.recurse_count+1});if(i=v.node,l++>40)throw new o.ErrnoError(32)}}return{path:s,node:i}},getPath:e=>{for(var r;;){if(o.isRoot(e)){var t=e.mount.mountpoint;return r?t[t.length-1]!=="/"?t+"/"+r:t+r:t}r=r?e.name+"/"+r:e.name,e=e.parent}},hashName:(e,r)=>{for(var t=0,n=0;n<r.length;n++)t=(t<<5)-t+r.charCodeAt(n)|0;return(e+t>>>0)%o.nameTable.length},hashAddNode:e=>{var r=o.hashName(e.parent.id,e.name);e.name_next=o.nameTable[r],o.nameTable[r]=e},hashRemoveNode:e=>{var r=o.hashName(e.parent.id,e.name);if(o.nameTable[r]===e)o.nameTable[r]=e.name_next;else for(var t=o.nameTable[r];t;){if(t.name_next===e){t.name_next=e.name_next;break}t=t.name_next}},lookupNode:(e,r)=>{var t=o.mayLookup(e);if(t)throw new o.ErrnoError(t,e);for(var n=o.hashName(e.id,r),i=o.nameTable[n];i;i=i.name_next){var s=i.name;if(i.parent.id===e.id&&s===r)return i}return o.lookup(e,r)},createNode:(e,r,t,n)=>{var i=new o.FSNode(e,r,t,n);return o.hashAddNode(i),i},destroyNode:e=>{o.hashRemoveNode(e)},isRoot:e=>e===e.parent,isMountpoint:e=>!!e.mounted,isFile:e=>(e&61440)===32768,isDir:e=>(e&61440)===16384,isLink:e=>(e&61440)===40960,isChrdev:e=>(e&61440)===8192,isBlkdev:e=>(e&61440)===24576,isFIFO:e=>(e&61440)===4096,isSocket:e=>(e&49152)===49152,flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:e=>{var r=o.flagModes[e];if(typeof r>"u")throw new Error("Unknown file open mode: "+e);return r},flagsToPermissionString:e=>{var r=["r","w","rw"][e&3];return e&512&&(r+="w"),r},nodePermissions:(e,r)=>o.ignorePermissions?0:r.includes("r")&&!(e.mode&292)||r.includes("w")&&!(e.mode&146)||r.includes("x")&&!(e.mode&73)?2:0,mayLookup:e=>{var r=o.nodePermissions(e,"x");return r||(e.node_ops.lookup?0:2)},mayCreate:(e,r)=>{try{var t=o.lookupNode(e,r);return 20}catch{}return o.nodePermissions(e,"wx")},mayDelete:(e,r,t)=>{var n;try{n=o.lookupNode(e,r)}catch(s){return s.errno}var i=o.nodePermissions(e,"wx");if(i)return i;if(t){if(!o.isDir(n.mode))return 54;if(o.isRoot(n)||o.getPath(n)===o.cwd())return 10}else if(o.isDir(n.mode))return 31;return 0},mayOpen:(e,r)=>e?o.isLink(e.mode)?32:o.isDir(e.mode)&&(o.flagsToPermissionString(r)!=="r"||r&512)?31:o.nodePermissions(e,o.flagsToPermissionString(r)):44,MAX_OPEN_FDS:4096,nextfd:(e=0,r=o.MAX_OPEN_FDS)=>{for(var t=e;t<=r;t++)if(!o.streams[t])return t;throw new o.ErrnoError(33)},getStream:e=>o.streams[e],createStream:(e,r,t)=>{o.FSStream||(o.FSStream=function(){this.shared={}},o.FSStream.prototype={},Object.defineProperties(o.FSStream.prototype,{object:{get:function(){return this.node},set:function(i){this.node=i}},isRead:{get:function(){return(this.flags&2097155)!==1}},isWrite:{get:function(){return(this.flags&2097155)!==0}},isAppend:{get:function(){return this.flags&1024}},flags:{get:function(){return this.shared.flags},set:function(i){this.shared.flags=i}},position:{get:function(){return this.shared.position},set:function(i){this.shared.position=i}}})),e=Object.assign(new o.FSStream,e);var n=o.nextfd(r,t);return e.fd=n,o.streams[n]=e,e},closeStream:e=>{o.streams[e]=null},chrdev_stream_ops:{open:e=>{var r=o.getDevice(e.node.rdev);e.stream_ops=r.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:()=>{throw new o.ErrnoError(70)}},major:e=>e>>8,minor:e=>e&255,makedev:(e,r)=>e<<8|r,registerDevice:(e,r)=>{o.devices[e]={stream_ops:r}},getDevice:e=>o.devices[e],getMounts:e=>{for(var r=[],t=[e];t.length;){var n=t.pop();r.push(n),t.push.apply(t,n.mounts)}return r},syncfs:(e,r)=>{typeof e=="function"&&(r=e,e=!1),o.syncFSRequests++,o.syncFSRequests>1&&G("warning: "+o.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var t=o.getMounts(o.root.mount),n=0;function i(c){return o.syncFSRequests--,r(c)}function s(c){if(c)return s.errored?void 0:(s.errored=!0,i(c));++n>=t.length&&i(null)}t.forEach(c=>{if(!c.type.syncfs)return s(null);c.type.syncfs(c,e,s)})},mount:(e,r,t)=>{var n=t==="/",i=!t,s;if(n&&o.root)throw new o.ErrnoError(10);if(!n&&!i){var c=o.lookupPath(t,{follow_mount:!1});if(t=c.path,s=c.node,o.isMountpoint(s))throw new o.ErrnoError(10);if(!o.isDir(s.mode))throw new o.ErrnoError(54)}var u={type:e,opts:r,mountpoint:t,mounts:[]},l=e.mount(u);return l.mount=u,u.root=l,n?o.root=l:s&&(s.mounted=u,s.mount&&s.mount.mounts.push(u)),l},unmount:e=>{var r=o.lookupPath(e,{follow_mount:!1});if(!o.isMountpoint(r.node))throw new o.ErrnoError(28);var t=r.node,n=t.mounted,i=o.getMounts(n);Object.keys(o.nameTable).forEach(c=>{for(var u=o.nameTable[c];u;){var l=u.name_next;i.includes(u.mount)&&o.destroyNode(u),u=l}}),t.mounted=null;var s=t.mount.mounts.indexOf(n);t.mount.mounts.splice(s,1)},lookup:(e,r)=>e.node_ops.lookup(e,r),mknod:(e,r,t)=>{var n=o.lookupPath(e,{parent:!0}),i=n.node,s=C.basename(e);if(!s||s==="."||s==="..")throw new o.ErrnoError(28);var c=o.mayCreate(i,s);if(c)throw new o.ErrnoError(c);if(!i.node_ops.mknod)throw new o.ErrnoError(63);return i.node_ops.mknod(i,s,r,t)},create:(e,r)=>(r=r!==void 0?r:438,r&=4095,r|=32768,o.mknod(e,r,0)),mkdir:(e,r)=>(r=r!==void 0?r:511,r&=1023,r|=16384,o.mknod(e,r,0)),mkdirTree:(e,r)=>{for(var t=e.split("/"),n="",i=0;i<t.length;++i)if(t[i]){n+="/"+t[i];try{o.mkdir(n,r)}catch(s){if(s.errno!=20)throw s}}},mkdev:(e,r,t)=>(typeof t>"u"&&(t=r,r=438),r|=8192,o.mknod(e,r,t)),symlink:(e,r)=>{if(!se.resolve(e))throw new o.ErrnoError(44);var t=o.lookupPath(r,{parent:!0}),n=t.node;if(!n)throw new o.ErrnoError(44);var i=C.basename(r),s=o.mayCreate(n,i);if(s)throw new o.ErrnoError(s);if(!n.node_ops.symlink)throw new o.ErrnoError(63);return n.node_ops.symlink(n,i,e)},rename:(e,r)=>{var t=C.dirname(e),n=C.dirname(r),i=C.basename(e),s=C.basename(r),c,u,l;if(c=o.lookupPath(e,{parent:!0}),u=c.node,c=o.lookupPath(r,{parent:!0}),l=c.node,!u||!l)throw new o.ErrnoError(44);if(u.mount!==l.mount)throw new o.ErrnoError(75);var f=o.lookupNode(u,i),v=se.relative(e,n);if(v.charAt(0)!==".")throw new o.ErrnoError(28);if(v=se.relative(r,t),v.charAt(0)!==".")throw new o.ErrnoError(55);var m;try{m=o.lookupNode(l,s)}catch{}if(f!==m){var h=o.isDir(f.mode),g=o.mayDelete(u,i,h);if(g)throw new o.ErrnoError(g);if(g=m?o.mayDelete(l,s,h):o.mayCreate(l,s),g)throw new o.ErrnoError(g);if(!u.node_ops.rename)throw new o.ErrnoError(63);if(o.isMountpoint(f)||m&&o.isMountpoint(m))throw new o.ErrnoError(10);if(l!==u&&(g=o.nodePermissions(u,"w"),g))throw new o.ErrnoError(g);o.hashRemoveNode(f);try{u.node_ops.rename(f,l,s)}catch(w){throw w}finally{o.hashAddNode(f)}}},rmdir:e=>{var r=o.lookupPath(e,{parent:!0}),t=r.node,n=C.basename(e),i=o.lookupNode(t,n),s=o.mayDelete(t,n,!0);if(s)throw new o.ErrnoError(s);if(!t.node_ops.rmdir)throw new o.ErrnoError(63);if(o.isMountpoint(i))throw new o.ErrnoError(10);t.node_ops.rmdir(t,n),o.destroyNode(i)},readdir:e=>{var r=o.lookupPath(e,{follow:!0}),t=r.node;if(!t.node_ops.readdir)throw new o.ErrnoError(54);return t.node_ops.readdir(t)},unlink:e=>{var r=o.lookupPath(e,{parent:!0}),t=r.node;if(!t)throw new o.ErrnoError(44);var n=C.basename(e),i=o.lookupNode(t,n),s=o.mayDelete(t,n,!1);if(s)throw new o.ErrnoError(s);if(!t.node_ops.unlink)throw new o.ErrnoError(63);if(o.isMountpoint(i))throw new o.ErrnoError(10);t.node_ops.unlink(t,n),o.destroyNode(i)},readlink:e=>{var r=o.lookupPath(e),t=r.node;if(!t)throw new o.ErrnoError(44);if(!t.node_ops.readlink)throw new o.ErrnoError(28);return se.resolve(o.getPath(t.parent),t.node_ops.readlink(t))},stat:(e,r)=>{var t=o.lookupPath(e,{follow:!r}),n=t.node;if(!n)throw new o.ErrnoError(44);if(!n.node_ops.getattr)throw new o.ErrnoError(63);return n.node_ops.getattr(n)},lstat:e=>o.stat(e,!0),chmod:(e,r,t)=>{var n;if(typeof e=="string"){var i=o.lookupPath(e,{follow:!t});n=i.node}else n=e;if(!n.node_ops.setattr)throw new o.ErrnoError(63);n.node_ops.setattr(n,{mode:r&4095|n.mode&-4096,timestamp:Date.now()})},lchmod:(e,r)=>{o.chmod(e,r,!0)},fchmod:(e,r)=>{var t=o.getStream(e);if(!t)throw new o.ErrnoError(8);o.chmod(t.node,r)},chown:(e,r,t,n)=>{var i;if(typeof e=="string"){var s=o.lookupPath(e,{follow:!n});i=s.node}else i=e;if(!i.node_ops.setattr)throw new o.ErrnoError(63);i.node_ops.setattr(i,{timestamp:Date.now()})},lchown:(e,r,t)=>{o.chown(e,r,t,!0)},fchown:(e,r,t)=>{var n=o.getStream(e);if(!n)throw new o.ErrnoError(8);o.chown(n.node,r,t)},truncate:(e,r)=>{if(r<0)throw new o.ErrnoError(28);var t;if(typeof e=="string"){var n=o.lookupPath(e,{follow:!0});t=n.node}else t=e;if(!t.node_ops.setattr)throw new o.ErrnoError(63);if(o.isDir(t.mode))throw new o.ErrnoError(31);if(!o.isFile(t.mode))throw new o.ErrnoError(28);var i=o.nodePermissions(t,"w");if(i)throw new o.ErrnoError(i);t.node_ops.setattr(t,{size:r,timestamp:Date.now()})},ftruncate:(e,r)=>{var t=o.getStream(e);if(!t)throw new o.ErrnoError(8);if(!(t.flags&2097155))throw new o.ErrnoError(28);o.truncate(t.node,r)},utime:(e,r,t)=>{var n=o.lookupPath(e,{follow:!0}),i=n.node;i.node_ops.setattr(i,{timestamp:Math.max(r,t)})},open:(e,r,t)=>{if(e==="")throw new o.ErrnoError(44);r=typeof r=="string"?o.modeStringToFlags(r):r,t=typeof t>"u"?438:t,r&64?t=t&4095|32768:t=0;var n;if(typeof e=="object")n=e;else{e=C.normalize(e);try{var i=o.lookupPath(e,{follow:!(r&131072)});n=i.node}catch{}}var s=!1;if(r&64)if(n){if(r&128)throw new o.ErrnoError(20)}else n=o.mknod(e,t,0),s=!0;if(!n)throw new o.ErrnoError(44);if(o.isChrdev(n.mode)&&(r&=-513),r&65536&&!o.isDir(n.mode))throw new o.ErrnoError(54);if(!s){var c=o.mayOpen(n,r);if(c)throw new o.ErrnoError(c)}r&512&&!s&&o.truncate(n,0),r&=-131713;var u=o.createStream({node:n,path:o.getPath(n),flags:r,seekable:!0,position:0,stream_ops:n.stream_ops,ungotten:[],error:!1});return u.stream_ops.open&&u.stream_ops.open(u),a.logReadFiles&&!(r&1)&&(o.readFiles||(o.readFiles={}),e in o.readFiles||(o.readFiles[e]=1)),u},close:e=>{if(o.isClosed(e))throw new o.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(r){throw r}finally{o.closeStream(e.fd)}e.fd=null},isClosed:e=>e.fd===null,llseek:(e,r,t)=>{if(o.isClosed(e))throw new o.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new o.ErrnoError(70);if(t!=0&&t!=1&&t!=2)throw new o.ErrnoError(28);return e.position=e.stream_ops.llseek(e,r,t),e.ungotten=[],e.position},read:(e,r,t,n,i)=>{if(n<0||i<0)throw new o.ErrnoError(28);if(o.isClosed(e))throw new o.ErrnoError(8);if((e.flags&2097155)===1)throw new o.ErrnoError(8);if(o.isDir(e.node.mode))throw new o.ErrnoError(31);if(!e.stream_ops.read)throw new o.ErrnoError(28);var s=typeof i<"u";if(!s)i=e.position;else if(!e.seekable)throw new o.ErrnoError(70);var c=e.stream_ops.read(e,r,t,n,i);return s||(e.position+=c),c},write:(e,r,t,n,i,s)=>{if(n<0||i<0)throw new o.ErrnoError(28);if(o.isClosed(e))throw new o.ErrnoError(8);if(!(e.flags&2097155))throw new o.ErrnoError(8);if(o.isDir(e.node.mode))throw new o.ErrnoError(31);if(!e.stream_ops.write)throw new o.ErrnoError(28);e.seekable&&e.flags&1024&&o.llseek(e,0,2);var c=typeof i<"u";if(!c)i=e.position;else if(!e.seekable)throw new o.ErrnoError(70);var u=e.stream_ops.write(e,r,t,n,i,s);return c||(e.position+=u),u},allocate:(e,r,t)=>{if(o.isClosed(e))throw new o.ErrnoError(8);if(r<0||t<=0)throw new o.ErrnoError(28);if(!(e.flags&2097155))throw new o.ErrnoError(8);if(!o.isFile(e.node.mode)&&!o.isDir(e.node.mode))throw new o.ErrnoError(43);if(!e.stream_ops.allocate)throw new o.ErrnoError(138);e.stream_ops.allocate(e,r,t)},mmap:(e,r,t,n,i)=>{if(n&2&&!(i&2)&&(e.flags&2097155)!==2)throw new o.ErrnoError(2);if((e.flags&2097155)===1)throw new o.ErrnoError(2);if(!e.stream_ops.mmap)throw new o.ErrnoError(43);return e.stream_ops.mmap(e,r,t,n,i)},msync:(e,r,t,n,i)=>!e||!e.stream_ops.msync?0:e.stream_ops.msync(e,r,t,n,i),munmap:e=>0,ioctl:(e,r,t)=>{if(!e.stream_ops.ioctl)throw new o.ErrnoError(59);return e.stream_ops.ioctl(e,r,t)},readFile:(e,r={})=>{if(r.flags=r.flags||0,r.encoding=r.encoding||"binary",r.encoding!=="utf8"&&r.encoding!=="binary")throw new Error('Invalid encoding type "'+r.encoding+'"');var t,n=o.open(e,r.flags),i=o.stat(e),s=i.size,c=new Uint8Array(s);return o.read(n,c,0,s,0),r.encoding==="utf8"?t=Pe(c,0):r.encoding==="binary"&&(t=c),o.close(n),t},writeFile:(e,r,t={})=>{t.flags=t.flags||577;var n=o.open(e,t.flags,t.mode);if(typeof r=="string"){var i=new Uint8Array(ar(r)+1),s=ir(r,i,0,i.length);o.write(n,i,0,s,void 0,t.canOwn)}else if(ArrayBuffer.isView(r))o.write(n,r,0,r.byteLength,void 0,t.canOwn);else throw new Error("Unsupported data type");o.close(n)},cwd:()=>o.currentPath,chdir:e=>{var r=o.lookupPath(e,{follow:!0});if(r.node===null)throw new o.ErrnoError(44);if(!o.isDir(r.node.mode))throw new o.ErrnoError(54);var t=o.nodePermissions(r.node,"x");if(t)throw new o.ErrnoError(t);o.currentPath=r.path},createDefaultDirectories:()=>{o.mkdir("/tmp"),o.mkdir("/home"),o.mkdir("/home/web_user")},createDefaultDevices:()=>{o.mkdir("/dev"),o.registerDevice(o.makedev(1,3),{read:()=>0,write:(r,t,n,i,s)=>i}),o.mkdev("/dev/null",o.makedev(1,3)),_e.register(o.makedev(5,0),_e.default_tty_ops),_e.register(o.makedev(6,0),_e.default_tty1_ops),o.mkdev("/dev/tty",o.makedev(5,0)),o.mkdev("/dev/tty1",o.makedev(6,0));var e=Dt();o.createDevice("/dev","random",e),o.createDevice("/dev","urandom",e),o.mkdir("/dev/shm"),o.mkdir("/dev/shm/tmp")},createSpecialDirectories:()=>{o.mkdir("/proc");var e=o.mkdir("/proc/self");o.mkdir("/proc/self/fd"),o.mount({mount:()=>{var r=o.createNode(e,"fd",16895,73);return r.node_ops={lookup:(t,n)=>{var i=+n,s=o.getStream(i);if(!s)throw new o.ErrnoError(8);var c={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>s.path}};return c.parent=c,c}},r}},{},"/proc/self/fd")},createStandardStreams:()=>{a.stdin?o.createDevice("/dev","stdin",a.stdin):o.symlink("/dev/tty","/dev/stdin"),a.stdout?o.createDevice("/dev","stdout",null,a.stdout):o.symlink("/dev/tty","/dev/stdout"),a.stderr?o.createDevice("/dev","stderr",null,a.stderr):o.symlink("/dev/tty1","/dev/stderr"),o.open("/dev/stdin",0),o.open("/dev/stdout",1),o.open("/dev/stderr",1)},ensureErrnoError:()=>{o.ErrnoError||(o.ErrnoError=function(r,t){this.node=t,this.setErrno=function(n){this.errno=n},this.setErrno(r),this.message="FS error"},o.ErrnoError.prototype=new Error,o.ErrnoError.prototype.constructor=o.ErrnoError,[44].forEach(e=>{o.genericErrors[e]=new o.ErrnoError(e),o.genericErrors[e].stack="<generic error, no stack>"}))},staticInit:()=>{o.ensureErrnoError(),o.nameTable=new Array(4096),o.mount(E,{},"/"),o.createDefaultDirectories(),o.createDefaultDevices(),o.createSpecialDirectories(),o.filesystems={MEMFS:E}},init:(e,r,t)=>{o.init.initialized=!0,o.ensureErrnoError(),a.stdin=e||a.stdin,a.stdout=r||a.stdout,a.stderr=t||a.stderr,o.createStandardStreams()},quit:()=>{o.init.initialized=!1;for(var e=0;e<o.streams.length;e++){var r=o.streams[e];r&&o.close(r)}},getMode:(e,r)=>{var t=0;return e&&(t|=365),r&&(t|=146),t},findObject:(e,r)=>{var t=o.analyzePath(e,r);return t.exists?t.object:null},analyzePath:(e,r)=>{try{var t=o.lookupPath(e,{follow:!r});e=t.path}catch{}var n={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var t=o.lookupPath(e,{parent:!0});n.parentExists=!0,n.parentPath=t.path,n.parentObject=t.node,n.name=C.basename(e),t=o.lookupPath(e,{follow:!r}),n.exists=!0,n.path=t.path,n.object=t.node,n.name=t.node.name,n.isRoot=t.path==="/"}catch(i){n.error=i.errno}return n},createPath:(e,r,t,n)=>{e=typeof e=="string"?e:o.getPath(e);for(var i=r.split("/").reverse();i.length;){var s=i.pop();if(s){var c=C.join2(e,s);try{o.mkdir(c)}catch{}e=c}}return c},createFile:(e,r,t,n,i)=>{var s=C.join2(typeof e=="string"?e:o.getPath(e),r),c=o.getMode(n,i);return o.create(s,c)},createDataFile:(e,r,t,n,i,s)=>{var c=r;e&&(e=typeof e=="string"?e:o.getPath(e),c=r?C.join2(e,r):e);var u=o.getMode(n,i),l=o.create(c,u);if(t){if(typeof t=="string"){for(var f=new Array(t.length),v=0,m=t.length;v<m;++v)f[v]=t.charCodeAt(v);t=f}o.chmod(l,u|146);var h=o.open(l,577);o.write(h,t,0,t.length,0,s),o.close(h),o.chmod(l,u)}return l},createDevice:(e,r,t,n)=>{var i=C.join2(typeof e=="string"?e:o.getPath(e),r),s=o.getMode(!!t,!!n);o.createDevice.major||(o.createDevice.major=64);var c=o.makedev(o.createDevice.major++,0);return o.registerDevice(c,{open:u=>{u.seekable=!1},close:u=>{n&&n.buffer&&n.buffer.length&&n(10)},read:(u,l,f,v,m)=>{for(var h=0,g=0;g<v;g++){var w;try{w=t()}catch{throw new o.ErrnoError(29)}if(w===void 0&&h===0)throw new o.ErrnoError(6);if(w==null)break;h++,l[f+g]=w}return h&&(u.node.timestamp=Date.now()),h},write:(u,l,f,v,m)=>{for(var h=0;h<v;h++)try{n(l[f+h])}catch{throw new o.ErrnoError(29)}return v&&(u.node.timestamp=Date.now()),h}}),o.mkdev(i,s,c)},forceLoadFile:e=>{if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(ee)try{e.contents=br(ee(e.url),!0),e.usedBytes=e.contents.length}catch{throw new o.ErrnoError(29)}else throw new Error("Cannot load without read() or XMLHttpRequest.")},createLazyFile:(e,r,t,n,i)=>{function s(){this.lengthKnown=!1,this.chunks=[]}if(s.prototype.get=function(g){if(!(g>this.length-1||g<0)){var w=g%this.chunkSize,T=g/this.chunkSize|0;return this.getter(T)[w]}},s.prototype.setDataGetter=function(g){this.getter=g},s.prototype.cacheLength=function(){var g=new XMLHttpRequest;if(g.open("HEAD",t,!1),g.send(null),!(g.status>=200&&g.status<300||g.status===304))throw new Error("Couldn't load "+t+". Status: "+g.status);var w=Number(g.getResponseHeader("Content-length")),T,$=(T=g.getResponseHeader("Accept-Ranges"))&&T==="bytes",j=(T=g.getResponseHeader("Content-Encoding"))&&T==="gzip",X=1024*1024;$||(X=w);var U=(Q,fe)=>{if(Q>fe)throw new Error("invalid range ("+Q+", "+fe+") or no bytes requested!");if(fe>w-1)throw new Error("only "+w+" bytes available! programmer error!");var I=new XMLHttpRequest;if(I.open("GET",t,!1),w!==X&&I.setRequestHeader("Range","bytes="+Q+"-"+fe),I.responseType="arraybuffer",I.overrideMimeType&&I.overrideMimeType("text/plain; charset=x-user-defined"),I.send(null),!(I.status>=200&&I.status<300||I.status===304))throw new Error("Couldn't load "+t+". Status: "+I.status);return I.response!==void 0?new Uint8Array(I.response||[]):br(I.responseText||"",!0)},be=this;be.setDataGetter(Q=>{var fe=Q*X,I=(Q+1)*X-1;if(I=Math.min(I,w-1),typeof be.chunks[Q]>"u"&&(be.chunks[Q]=U(fe,I)),typeof be.chunks[Q]>"u")throw new Error("doXHR failed!");return be.chunks[Q]}),(j||!w)&&(X=w=1,w=this.getter(0).length,X=w,M("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=w,this._chunkSize=X,this.lengthKnown=!0},typeof XMLHttpRequest<"u"){if(!V)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var c=new s;Object.defineProperties(c,{length:{get:function(){return this.lengthKnown||this.cacheLength(),this._length}},chunkSize:{get:function(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}});var u={isDevice:!1,contents:c}}else var u={isDevice:!1,url:t};var l=o.createFile(e,r,u,n,i);u.contents?l.contents=u.contents:u.url&&(l.contents=null,l.url=u.url),Object.defineProperties(l,{usedBytes:{get:function(){return this.contents.length}}});var f={},v=Object.keys(l.stream_ops);v.forEach(h=>{var g=l.stream_ops[h];f[h]=function(){return o.forceLoadFile(l),g.apply(null,arguments)}});function m(h,g,w,T,$){var j=h.node.contents;if($>=j.length)return 0;var X=Math.min(j.length-$,T);if(j.slice)for(var U=0;U<X;U++)g[w+U]=j[$+U];else for(var U=0;U<X;U++)g[w+U]=j.get($+U);return X}return f.read=(h,g,w,T,$)=>(o.forceLoadFile(l),m(h,g,w,T,$)),f.mmap=(h,g,w,T,$)=>{o.forceLoadFile(l);var j=jr(g);if(!j)throw new o.ErrnoError(48);return m(h,K,j,g,w),{ptr:j,allocated:!0}},l.stream_ops=f,l},createPreloadedFile:(e,r,t,n,i,s,c,u,l,f)=>{var v=r?se.resolve(C.join2(e,r)):e;function m(h){function g(w){f&&f(),u||o.createDataFile(e,r,w,n,i,l),s&&s(),We()}Browser.handledByPreloadPlugin(h,v,g,()=>{c&&c(),We()})||g(h)}ur(),typeof t=="string"?Ft(t,h=>m(h),c):m(t)},indexedDB:()=>window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,DB_NAME:()=>"EM_FS_"+window.location.pathname,DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:(e,r,t)=>{r=r||(()=>{}),t=t||(()=>{});var n=o.indexedDB();try{var i=n.open(o.DB_NAME(),o.DB_VERSION)}catch(s){return t(s)}i.onupgradeneeded=()=>{M("creating db");var s=i.result;s.createObjectStore(o.DB_STORE_NAME)},i.onsuccess=()=>{var s=i.result,c=s.transaction([o.DB_STORE_NAME],"readwrite"),u=c.objectStore(o.DB_STORE_NAME),l=0,f=0,v=e.length;function m(){f==0?r():t()}e.forEach(h=>{var g=u.put(o.analyzePath(h).object.contents,h);g.onsuccess=()=>{l++,l+f==v&&m()},g.onerror=()=>{f++,l+f==v&&m()}}),c.onerror=t},i.onerror=t},loadFilesFromDB:(e,r,t)=>{r=r||(()=>{}),t=t||(()=>{});var n=o.indexedDB();try{var i=n.open(o.DB_NAME(),o.DB_VERSION)}catch(s){return t(s)}i.onupgradeneeded=t,i.onsuccess=()=>{var s=i.result;try{var c=s.transaction([o.DB_STORE_NAME],"readonly")}catch(h){t(h);return}var u=c.objectStore(o.DB_STORE_NAME),l=0,f=0,v=e.length;function m(){f==0?r():t()}e.forEach(h=>{var g=u.get(h);g.onsuccess=()=>{o.analyzePath(h).exists&&o.unlink(h),o.createDataFile(C.dirname(h),C.basename(h),g.result,!0,!0,!0),l++,l+f==v&&m()},g.onerror=()=>{f++,l+f==v&&m()}}),c.onerror=t},i.onerror=t}},H={DEFAULT_POLLMASK:5,calculateAt:function(e,r,t){if(C.isAbs(r))return r;var n;if(e===-100)n=o.cwd();else{var i=o.getStream(e);if(!i)throw new o.ErrnoError(8);n=i.path}if(r.length==0){if(!t)throw new o.ErrnoError(44);return n}return C.join2(n,r)},doStat:function(e,r,t){try{var n=e(r)}catch(i){if(i&&i.node&&C.normalize(r)!==C.normalize(o.getPath(i.node)))return-54;throw i}return P[t>>2]=n.dev,P[t+4>>2]=0,P[t+8>>2]=n.ino,P[t+12>>2]=n.mode,P[t+16>>2]=n.nlink,P[t+20>>2]=n.uid,P[t+24>>2]=n.gid,P[t+28>>2]=n.rdev,P[t+32>>2]=0,ae=[n.size>>>0,(N=n.size,+Math.abs(N)>=1?N>0?(Math.min(+Math.floor(N/4294967296),4294967295)|0)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],P[t+40>>2]=ae[0],P[t+44>>2]=ae[1],P[t+48>>2]=4096,P[t+52>>2]=n.blocks,P[t+56>>2]=n.atime.getTime()/1e3|0,P[t+60>>2]=0,P[t+64>>2]=n.mtime.getTime()/1e3|0,P[t+68>>2]=0,P[t+72>>2]=n.ctime.getTime()/1e3|0,P[t+76>>2]=0,ae=[n.ino>>>0,(N=n.ino,+Math.abs(N)>=1?N>0?(Math.min(+Math.floor(N/4294967296),4294967295)|0)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],P[t+80>>2]=ae[0],P[t+84>>2]=ae[1],0},doMsync:function(e,r,t,n,i){var s=L.slice(e,e+t);o.msync(r,s,i,t,n)},varargs:void 0,get:function(){H.varargs+=4;var e=P[H.varargs-4>>2];return e},getStr:function(e){var r=Dr(e);return r},getStreamFromFD:function(e){var r=o.getStream(e);if(!r)throw new o.ErrnoError(8);return r}};function St(e,r,t){H.varargs=t;try{var n=H.getStreamFromFD(e);switch(r){case 0:{var i=H.get();if(i<0)return-28;var s;return s=o.createStream(n,i),s.fd}case 1:case 2:return 0;case 3:return n.flags;case 4:{var i=H.get();return n.flags|=i,0}case 5:{var i=H.get(),c=0;return ge[i+c>>1]=2,0}case 6:case 7:return 0;case 16:case 8:return-28;case 9:return Ct(28),-1;default:return-28}}catch(u){if(typeof o>"u"||!(u instanceof o.ErrnoError))throw u;return-u.errno}}function Rt(e,r,t,n){H.varargs=n;try{r=H.getStr(r),r=H.calculateAt(e,r);var i=n?H.get():0;return o.open(r,t,i).fd}catch(s){if(typeof o>"u"||!(s instanceof o.ErrnoError))throw s;return-s.errno}}function Ot(e,r,t,n,i){}function lr(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function $t(){for(var e=new Array(256),r=0;r<256;++r)e[r]=String.fromCharCode(r);Ur=e}var Ur=void 0;function Y(e){for(var r="",t=e;L[t];)r+=Ur[L[t++]];return r}var ke={},Ee={},Xe={},It=48,Mt=57;function Je(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var r=e.charCodeAt(0);return r>=It&&r<=Mt?"_"+e:e}function fr(e,r){return e=Je(e),new Function("body","return function "+e+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(r)}function dr(e,r){var t=fr(r,function(n){this.name=r,this.message=n;var i=new Error(n).stack;i!==void 0&&(this.stack=this.toString()+`
`+i.replace(/^Error(:[^\n]*)?\n/,""))});return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},t}var Ce=void 0;function D(e){throw new Ce(e)}var Vr=void 0;function Ke(e){throw new Vr(e)}function Se(e,r,t){e.forEach(function(u){Xe[u]=r});function n(u){var l=t(u);l.length!==e.length&&Ke("Mismatched type converter count");for(var f=0;f<e.length;++f)ue(e[f],l[f])}var i=new Array(r.length),s=[],c=0;r.forEach((u,l)=>{Ee.hasOwnProperty(u)?i[l]=Ee[u]:(s.push(u),ke.hasOwnProperty(u)||(ke[u]=[]),ke[u].push(()=>{i[l]=Ee[u],++c,c===s.length&&n(i)}))}),s.length===0&&n(i)}function ue(e,r,t={}){if(!("argPackAdvance"in r))throw new TypeError("registerType registeredInstance requires argPackAdvance");var n=r.name;if(e||D('type "'+n+'" must have a positive integer typeid pointer'),Ee.hasOwnProperty(e)){if(t.ignoreDuplicateRegistrations)return;D("Cannot register type '"+n+"' twice")}if(Ee[e]=r,delete Xe[e],ke.hasOwnProperty(e)){var i=ke[e];delete ke[e],i.forEach(s=>s())}}function Nt(e,r,t,n,i){var s=lr(t);r=Y(r),ue(e,{name:r,fromWireType:function(c){return!!c},toWireType:function(c,u){return u?n:i},argPackAdvance:8,readValueFromPointer:function(c){var u;if(t===1)u=K;else if(t===2)u=ge;else if(t===4)u=P;else throw new TypeError("Unknown boolean type size: "+r);return this.fromWireType(u[c>>s])},destructorFunction:null})}function jt(e){if(!(this instanceof pe)||!(e instanceof pe))return!1;for(var r=this.$$.ptrType.registeredClass,t=this.$$.ptr,n=e.$$.ptrType.registeredClass,i=e.$$.ptr;r.baseClass;)t=r.upcast(t),r=r.baseClass;for(;n.baseClass;)i=n.upcast(i),n=n.baseClass;return r===n&&t===i}function Ut(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function hr(e){function r(t){return t.$$.ptrType.registeredClass.name}D(r(e)+" instance already deleted")}var pr=!1;function zr(e){}function Vt(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function Br(e){e.count.value-=1;var r=e.count.value===0;r&&Vt(e)}function Lr(e,r,t){if(r===t)return e;if(t.baseClass===void 0)return null;var n=Lr(e,r,t.baseClass);return n===null?null:t.downcast(n)}var Hr={};function zt(){return Object.keys($e).length}function Bt(){var e=[];for(var r in $e)$e.hasOwnProperty(r)&&e.push($e[r]);return e}var Re=[];function vr(){for(;Re.length;){var e=Re.pop();e.$$.deleteScheduled=!1,e.delete()}}var Oe=void 0;function Lt(e){Oe=e,Re.length&&Oe&&Oe(vr)}function Ht(){a.getInheritedInstanceCount=zt,a.getLiveInheritedInstances=Bt,a.flushPendingDeletes=vr,a.setDelayFunction=Lt}var $e={};function xt(e,r){for(r===void 0&&D("ptr should not be undefined");e.baseClass;)r=e.upcast(r),e=e.baseClass;return r}function Wt(e,r){return r=xt(e,r),$e[r]}function Ye(e,r){(!r.ptrType||!r.ptr)&&Ke("makeClassHandle requires ptr and ptrType");var t=!!r.smartPtrType,n=!!r.smartPtr;return t!==n&&Ke("Both smartPtrType and smartPtr must be specified"),r.count={value:1},Ie(Object.create(e,{$$:{value:r}}))}function Gt(e){var r=this.getPointee(e);if(!r)return this.destructor(e),null;var t=Wt(this.registeredClass,r);if(t!==void 0){if(t.$$.count.value===0)return t.$$.ptr=r,t.$$.smartPtr=e,t.clone();var n=t.clone();return this.destructor(e),n}function i(){return this.isSmartPointer?Ye(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:r,smartPtrType:this,smartPtr:e}):Ye(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var s=this.registeredClass.getActualType(r),c=Hr[s];if(!c)return i.call(this);var u;this.isConst?u=c.constPointerType:u=c.pointerType;var l=Lr(r,this.registeredClass,u.registeredClass);return l===null?i.call(this):this.isSmartPointer?Ye(u.registeredClass.instancePrototype,{ptrType:u,ptr:l,smartPtrType:this,smartPtr:e}):Ye(u.registeredClass.instancePrototype,{ptrType:u,ptr:l})}function Ie(e){return typeof FinalizationRegistry>"u"?(Ie=r=>r,e):(pr=new FinalizationRegistry(r=>{Br(r.$$)}),Ie=r=>{var t=r.$$,n=!!t.smartPtr;if(n){var i={$$:t};pr.register(r,i,r)}return r},zr=r=>pr.unregister(r),Ie(e))}function qt(){if(this.$$.ptr||hr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=Ie(Object.create(Object.getPrototypeOf(this),{$$:{value:Ut(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function Xt(){this.$$.ptr||hr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&D("Object already scheduled for deletion"),zr(this),Br(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Jt(){return!this.$$.ptr}function Kt(){return this.$$.ptr||hr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&D("Object already scheduled for deletion"),Re.push(this),Re.length===1&&Oe&&Oe(vr),this.$$.deleteScheduled=!0,this}function Yt(){pe.prototype.isAliasOf=jt,pe.prototype.clone=qt,pe.prototype.delete=Xt,pe.prototype.isDeleted=Jt,pe.prototype.deleteLater=Kt}function pe(){}function xr(e,r,t){if(e[r].overloadTable===void 0){var n=e[r];e[r]=function(){return e[r].overloadTable.hasOwnProperty(arguments.length)||D("Function '"+t+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[r].overloadTable+")!"),e[r].overloadTable[arguments.length].apply(this,arguments)},e[r].overloadTable=[],e[r].overloadTable[n.argCount]=n}}function Qt(e,r,t){a.hasOwnProperty(e)?((t===void 0||a[e].overloadTable!==void 0&&a[e].overloadTable[t]!==void 0)&&D("Cannot register public name '"+e+"' twice"),xr(a,e,e),a.hasOwnProperty(t)&&D("Cannot register multiple overloads of a function with the same number of arguments ("+t+")!"),a[e].overloadTable[t]=r):(a[e]=r,t!==void 0&&(a[e].numArguments=t))}function Zt(e,r,t,n,i,s,c,u){this.name=e,this.constructor=r,this.instancePrototype=t,this.rawDestructor=n,this.baseClass=i,this.getActualType=s,this.upcast=c,this.downcast=u,this.pureVirtualFunctions=[]}function mr(e,r,t){for(;r!==t;)r.upcast||D("Expected null or instance of "+t.name+", got an instance of "+r.name),e=r.upcast(e),r=r.baseClass;return e}function en(e,r){if(r===null)return this.isReference&&D("null is not a valid "+this.name),0;r.$$||D('Cannot pass "'+wr(r)+'" as a '+this.name),r.$$.ptr||D("Cannot pass deleted object as a pointer of type "+this.name);var t=r.$$.ptrType.registeredClass,n=mr(r.$$.ptr,t,this.registeredClass);return n}function rn(e,r){var t;if(r===null)return this.isReference&&D("null is not a valid "+this.name),this.isSmartPointer?(t=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,t),t):0;r.$$||D('Cannot pass "'+wr(r)+'" as a '+this.name),r.$$.ptr||D("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&r.$$.ptrType.isConst&&D("Cannot convert argument of type "+(r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name)+" to parameter type "+this.name);var n=r.$$.ptrType.registeredClass;if(t=mr(r.$$.ptr,n,this.registeredClass),this.isSmartPointer)switch(r.$$.smartPtr===void 0&&D("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:r.$$.smartPtrType===this?t=r.$$.smartPtr:D("Cannot convert argument of type "+(r.$$.smartPtrType?r.$$.smartPtrType.name:r.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:t=r.$$.smartPtr;break;case 2:if(r.$$.smartPtrType===this)t=r.$$.smartPtr;else{var i=r.clone();t=this.rawShare(t,Ze.toHandle(function(){i.delete()})),e!==null&&e.push(this.rawDestructor,t)}break;default:D("Unsupporting sharing policy")}return t}function tn(e,r){if(r===null)return this.isReference&&D("null is not a valid "+this.name),0;r.$$||D('Cannot pass "'+wr(r)+'" as a '+this.name),r.$$.ptr||D("Cannot pass deleted object as a pointer of type "+this.name),r.$$.ptrType.isConst&&D("Cannot convert argument of type "+r.$$.ptrType.name+" to parameter type "+this.name);var t=r.$$.ptrType.registeredClass,n=mr(r.$$.ptr,t,this.registeredClass);return n}function Qe(e){return this.fromWireType(A[e>>2])}function nn(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function on(e){this.rawDestructor&&this.rawDestructor(e)}function an(e){e!==null&&e.delete()}function sn(){ce.prototype.getPointee=nn,ce.prototype.destructor=on,ce.prototype.argPackAdvance=8,ce.prototype.readValueFromPointer=Qe,ce.prototype.deleteObject=an,ce.prototype.fromWireType=Gt}function ce(e,r,t,n,i,s,c,u,l,f,v){this.name=e,this.registeredClass=r,this.isReference=t,this.isConst=n,this.isSmartPointer=i,this.pointeeType=s,this.sharingPolicy=c,this.rawGetPointee=u,this.rawConstructor=l,this.rawShare=f,this.rawDestructor=v,!i&&r.baseClass===void 0?n?(this.toWireType=en,this.destructorFunction=null):(this.toWireType=tn,this.destructorFunction=null):this.toWireType=rn}function un(e,r,t){a.hasOwnProperty(e)||Ke("Replacing nonexistant public symbol"),a[e].overloadTable!==void 0&&t!==void 0?a[e].overloadTable[t]=r:(a[e]=r,a[e].argCount=t)}function cn(e,r,t){var n=a["dynCall_"+e];return t&&t.length?n.apply(null,[r].concat(t)):n.call(null,r)}function ln(e,r,t){return e.includes("j")?cn(e,r,t):qe(r).apply(null,t)}function fn(e,r){var t=[];return function(){return t.length=0,Object.assign(t,arguments),ln(e,r,t)}}function De(e,r){e=Y(e);function t(){return e.includes("j")?fn(e,r):qe(r)}var n=t();return typeof n!="function"&&D("unknown function pointer with signature "+e+": "+r),n}var Wr=void 0;function Gr(e){var r=et(e),t=Y(r);return le(r),t}function gr(e,r){var t=[],n={};function i(s){if(!n[s]&&!Ee[s]){if(Xe[s]){Xe[s].forEach(i);return}t.push(s),n[s]=!0}}throw r.forEach(i),new Wr(e+": "+t.map(Gr).join([", "]))}function dn(e,r,t,n,i,s,c,u,l,f,v,m,h){v=Y(v),s=De(i,s),u&&(u=De(c,u)),f&&(f=De(l,f)),h=De(m,h);var g=Je(v);Qt(g,function(){gr("Cannot construct "+v+" due to unbound types",[n])}),Se([e,r,t],n?[n]:[],function(w){w=w[0];var T,$;n?(T=w.registeredClass,$=T.instancePrototype):$=pe.prototype;var j=fr(g,function(){if(Object.getPrototypeOf(this)!==X)throw new Ce("Use 'new' to construct "+v);if(U.constructor_body===void 0)throw new Ce(v+" has no accessible constructor");var I=U.constructor_body[arguments.length];if(I===void 0)throw new Ce("Tried to invoke ctor of "+v+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(U.constructor_body).toString()+") parameters instead!");return I.apply(this,arguments)}),X=Object.create($,{constructor:{value:j}});j.prototype=X;var U=new Zt(v,j,X,h,T,s,u,f),be=new ce(v,U,!0,!1,!1),Q=new ce(v+"*",U,!1,!1,!1),fe=new ce(v+" const*",U,!1,!0,!1);return Hr[e]={pointerType:Q,constPointerType:fe},un(g,j),[be,Q,fe]})}function qr(e,r){for(var t=[],n=0;n<e;n++)t.push(P[(r>>2)+n]);return t}function hn(e){for(;e.length;){var r=e.pop(),t=e.pop();t(r)}}function Xr(e,r){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var t=fr(e.name||"unknownFunctionName",function(){});t.prototype=e.prototype;var n=new t,i=e.apply(n,r);return i instanceof Object?i:n}function Jr(e,r,t,n,i){var s=r.length;s<2&&D("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var c=r[1]!==null&&t!==null,u=!1,l=1;l<r.length;++l)if(r[l]!==null&&r[l].destructorFunction===void 0){u=!0;break}for(var f=r[0].name!=="void",v="",m="",l=0;l<s-2;++l)v+=(l!==0?", ":"")+"arg"+l,m+=(l!==0?", ":"")+"arg"+l+"Wired";var h="return function "+Je(e)+"("+v+`) {
if (arguments.length !== `+(s-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(s-2)+` args!');
}
`;u&&(h+=`var destructors = [];
`);var g=u?"destructors":"null",w=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],T=[D,n,i,hn,r[0],r[1]];c&&(h+="var thisWired = classParam.toWireType("+g+`, this);
`);for(var l=0;l<s-2;++l)h+="var arg"+l+"Wired = argType"+l+".toWireType("+g+", arg"+l+"); // "+r[l+2].name+`
`,w.push("argType"+l),T.push(r[l+2]);if(c&&(m="thisWired"+(m.length>0?", ":"")+m),h+=(f?"var rv = ":"")+"invoker(fn"+(m.length>0?", ":"")+m+`);
`,u)h+=`runDestructors(destructors);
`;else for(var l=c?1:2;l<r.length;++l){var $=l===1?"thisWired":"arg"+(l-2)+"Wired";r[l].destructorFunction!==null&&(h+=$+"_dtor("+$+"); // "+r[l].name+`
`,w.push($+"_dtor"),T.push(r[l].destructorFunction))}f&&(h+=`var ret = retType.fromWireType(rv);
return ret;
`),h+=`}
`,w.push(h);var j=Xr(Function,w).apply(null,T);return j}function pn(e,r,t,n,i,s){kr(r>0);var c=qr(r,t);i=De(n,i),Se([],[e],function(u){u=u[0];var l="constructor "+u.name;if(u.registeredClass.constructor_body===void 0&&(u.registeredClass.constructor_body=[]),u.registeredClass.constructor_body[r-1]!==void 0)throw new Ce("Cannot register multiple constructors with identical number of parameters ("+(r-1)+") for class '"+u.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return u.registeredClass.constructor_body[r-1]=()=>{gr("Cannot construct "+u.name+" due to unbound types",c)},Se([],c,function(f){return f.splice(1,0,null),u.registeredClass.constructor_body[r-1]=Jr(l,f,null,i,s),[]}),[]})}function vn(e,r,t,n,i,s,c,u){var l=qr(t,n);r=Y(r),s=De(i,s),Se([],[e],function(f){f=f[0];var v=f.name+"."+r;r.startsWith("@@")&&(r=Symbol[r.substring(2)]),u&&f.registeredClass.pureVirtualFunctions.push(r);function m(){gr("Cannot call "+v+" due to unbound types",l)}var h=f.registeredClass.instancePrototype,g=h[r];return g===void 0||g.overloadTable===void 0&&g.className!==f.name&&g.argCount===t-2?(m.argCount=t-2,m.className=f.name,h[r]=m):(xr(h,r,v),h[r].overloadTable[t-2]=m),Se([],l,function(w){var T=Jr(v,w,f,s,c);return h[r].overloadTable===void 0?(T.argCount=t-2,h[r]=T):h[r].overloadTable[t-2]=T,[]}),[]})}var yr=[],oe=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Kr(e){e>4&&--oe[e].refcount===0&&(oe[e]=void 0,yr.push(e))}function mn(){for(var e=0,r=5;r<oe.length;++r)oe[r]!==void 0&&++e;return e}function gn(){for(var e=5;e<oe.length;++e)if(oe[e]!==void 0)return oe[e];return null}function yn(){a.count_emval_handles=mn,a.get_first_emval=gn}var Ze={toValue:e=>(e||D("Cannot use deleted val. handle = "+e),oe[e].value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var r=yr.length?yr.pop():oe.length;return oe[r]={refcount:1,value:e},r}}}};function wn(e,r){r=Y(r),ue(e,{name:r,fromWireType:function(t){var n=Ze.toValue(t);return Kr(t),n},toWireType:function(t,n){return Ze.toHandle(n)},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:null})}function wr(e){if(e===null)return"null";var r=typeof e;return r==="object"||r==="array"||r==="function"?e.toString():""+e}function _n(e,r){switch(r){case 2:return function(t){return this.fromWireType(Ar[t>>2])};case 3:return function(t){return this.fromWireType(Fr[t>>3])};default:throw new TypeError("Unknown float type: "+e)}}function En(e,r,t){var n=lr(t);r=Y(r),ue(e,{name:r,fromWireType:function(i){return i},toWireType:function(i,s){return s},argPackAdvance:8,readValueFromPointer:_n(r,n),destructorFunction:null})}function bn(e,r,t){switch(r){case 0:return t?function(i){return K[i]}:function(i){return L[i]};case 1:return t?function(i){return ge[i>>1]}:function(i){return xe[i>>1]};case 2:return t?function(i){return P[i>>2]}:function(i){return A[i>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function Pn(e,r,t,n,i){r=Y(r);var s=lr(t),c=m=>m;if(n===0){var u=32-8*t;c=m=>m<<u>>>u}var l=r.includes("unsigned"),f=(m,h)=>{},v;l?v=function(m,h){return f(h,this.name),h>>>0}:v=function(m,h){return f(h,this.name),h},ue(e,{name:r,fromWireType:c,toWireType:v,argPackAdvance:8,readValueFromPointer:bn(r,s,n!==0),destructorFunction:null})}function kn(e,r,t){var n=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],i=n[r];function s(c){c=c>>2;var u=A,l=u[c],f=u[c+1];return new i(sr,f,l)}t=Y(t),ue(e,{name:t,fromWireType:s,argPackAdvance:8,readValueFromPointer:s},{ignoreDuplicateRegistrations:!0})}function Cn(e,r){r=Y(r);var t=r==="std::string";ue(e,{name:r,fromWireType:function(n){var i=A[n>>2],s;if(t)for(var c=n+4,u=0;u<=i;++u){var l=n+4+u;if(u==i||L[l]==0){var f=l-c,v=Dr(c,f);s===void 0?s=v:(s+=String.fromCharCode(0),s+=v),c=l+1}}else{for(var m=new Array(i),u=0;u<i;++u)m[u]=String.fromCharCode(L[n+4+u]);s=m.join("")}return le(n),s},toWireType:function(n,i){i instanceof ArrayBuffer&&(i=new Uint8Array(i));var s,c=typeof i=="string";c||i instanceof Uint8Array||i instanceof Uint8ClampedArray||i instanceof Int8Array||D("Cannot pass non-string to std::string"),t&&c?s=()=>ar(i):s=()=>i.length;var u=s(),l=tr(4+u+1);if(A[l>>2]=u,t&&c)ot(i,l+4,u+1);else if(c)for(var f=0;f<u;++f){var v=i.charCodeAt(f);v>255&&(le(l),D("String has UTF-16 code units that do not fit in 8 bits")),L[l+4+f]=v}else for(var f=0;f<u;++f)L[l+4+f]=i[f];return n!==null&&n.push(le,l),l},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:function(n){le(n)}})}function Dn(e,r,t){t=Y(t);var n,i,s,c,u;r===2?(n=it,i=at,c=st,s=()=>xe,u=1):r===4&&(n=ut,i=ct,c=lt,s=()=>A,u=2),ue(e,{name:t,fromWireType:function(l){for(var f=A[l>>2],v=s(),m,h=l+4,g=0;g<=f;++g){var w=l+4+g*r;if(g==f||v[w>>u]==0){var T=w-h,$=n(h,T);m===void 0?m=$:(m+=String.fromCharCode(0),m+=$),h=w+r}}return le(l),m},toWireType:function(l,f){typeof f!="string"&&D("Cannot pass non-string to C++ string type "+t);var v=c(f),m=tr(4+v+r);return A[m>>2]=v>>u,i(f,m+4,v+r),l!==null&&l.push(le,m),m},argPackAdvance:8,readValueFromPointer:Qe,destructorFunction:function(l){le(l)}})}function Tn(e,r){r=Y(r),ue(e,{isVoid:!0,name:r,argPackAdvance:0,fromWireType:function(){},toWireType:function(t,n){}})}function An(){return Date.now()}var Fn={};function Sn(e){var r=Fn[e];return r===void 0?Y(e):r}var _r=[];function Rn(e,r,t,n){e=_r[e],r=Ze.toValue(r),t=Sn(t),e(r,t,null,n)}function On(e){var r=_r.length;return _r.push(e),r}function $n(e,r){var t=Ee[e];return t===void 0&&D(r+" has unknown type "+Gr(e)),t}function In(e,r){for(var t=new Array(e),n=0;n<e;++n)t[n]=$n(A[r+n*de>>2],"parameter "+n);return t}var Yr=[];function Mn(e,r){var t=In(e,r),n=t[0],i=n.name+"_$"+t.slice(1).map(function(w){return w.name}).join("_")+"$",s=Yr[i];if(s!==void 0)return s;for(var c=["retType"],u=[n],l="",f=0;f<e-1;++f)l+=(f!==0?", ":"")+"arg"+f,c.push("argType"+f),u.push(t[1+f]);for(var v=Je("methodCaller_"+i),m="return function "+v+`(handle, name, destructors, args) {
`,h=0,f=0;f<e-1;++f)m+="    var arg"+f+" = argType"+f+".readValueFromPointer(args"+(h?"+"+h:"")+`);
`,h+=t[f+1].argPackAdvance;m+="    var rv = handle[name]("+l+`);
`;for(var f=0;f<e-1;++f)t[f+1].deleteObject&&(m+="    argType"+f+".deleteObject(arg"+f+`);
`);n.isVoid||(m+=`    return retType.toWireType(destructors, rv);
`),m+=`};
`,c.push(m);var g=Xr(Function,c).apply(null,u);return s=On(g),Yr[i]=s,s}function Nn(){we("")}function jn(){return L.length}function Un(){return jn()}function Vn(e,r,t){L.copyWithin(e,r,r+t)}function zn(e){we("OOM")}function Bn(e){L.length,zn()}var Er={};function Ln(){return k||"./this.program"}function Me(){if(!Me.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",r={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:Ln()};for(var t in Er)Er[t]===void 0?delete r[t]:r[t]=Er[t];var n=[];for(var t in r)n.push(t+"="+r[t]);Me.strings=n}return Me.strings}function Hn(e,r){var t=0;return Me().forEach(function(n,i){var s=r+t;A[e+i*4>>2]=s,ft(n,s),t+=n.length+1}),0}function xn(e,r){var t=Me();A[e>>2]=t.length;var n=0;return t.forEach(function(i){n+=i.length+1}),A[r>>2]=n,0}function Wn(e){try{var r=H.getStreamFromFD(e);return o.close(r),0}catch(t){if(typeof o>"u"||!(t instanceof o.ErrnoError))throw t;return t.errno}}function Gn(e,r){try{var t=H.getStreamFromFD(e),n=t.tty?2:o.isDir(t.mode)?3:o.isLink(t.mode)?7:4;return K[r>>0]=n,0}catch(i){if(typeof o>"u"||!(i instanceof o.ErrnoError))throw i;return i.errno}}function qn(e,r,t,n){for(var i=0,s=0;s<t;s++){var c=A[r>>2],u=A[r+4>>2];r+=8;var l=o.read(e,K,c,u,n);if(l<0)return-1;if(i+=l,l<u)break}return i}function Xn(e,r,t,n){try{var i=H.getStreamFromFD(e),s=qn(i,r,t);return P[n>>2]=s,0}catch(c){if(typeof o>"u"||!(c instanceof o.ErrnoError))throw c;return c.errno}}function Jn(e,r){return r+2097152>>>0<4194305-!!e?(e>>>0)+r*4294967296:NaN}function Kn(e,r,t,n,i){try{var s=Jn(r,t);if(isNaN(s))return 61;var c=H.getStreamFromFD(e);return o.llseek(c,s,n),ae=[c.position>>>0,(N=c.position,+Math.abs(N)>=1?N>0?(Math.min(+Math.floor(N/4294967296),4294967295)|0)>>>0:~~+Math.ceil((N-+(~~N>>>0))/4294967296)>>>0:0)],P[i>>2]=ae[0],P[i+4>>2]=ae[1],c.getdents&&s===0&&n===0&&(c.getdents=null),0}catch(u){if(typeof o>"u"||!(u instanceof o.ErrnoError))throw u;return u.errno}}function Yn(e,r,t,n){for(var i=0,s=0;s<t;s++){var c=A[r>>2],u=A[r+4>>2];r+=8;var l=o.write(e,K,c,u,n);if(l<0)return-1;i+=l}return i}function Qn(e,r,t,n){try{var i=H.getStreamFromFD(e),s=Yn(i,r,t);return A[n>>2]=s,0}catch(c){if(typeof o>"u"||!(c instanceof o.ErrnoError))throw c;return c.errno}}function Zn(e){}var Qr=function(e,r,t,n){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=o.nextInode++,this.name=r,this.mode=t,this.node_ops={},this.stream_ops={},this.rdev=n},er=365,rr=146;Object.defineProperties(Qr.prototype,{read:{get:function(){return(this.mode&er)===er},set:function(e){e?this.mode|=er:this.mode&=~er}},write:{get:function(){return(this.mode&rr)===rr},set:function(e){e?this.mode|=rr:this.mode&=~rr}},isFolder:{get:function(){return o.isDir(this.mode)}},isDevice:{get:function(){return o.isChrdev(this.mode)}}}),o.FSNode=Qr,o.staticInit(),$t(),Ce=a.BindingError=dr(Error,"BindingError"),Vr=a.InternalError=dr(Error,"InternalError"),Yt(),Ht(),sn(),Wr=a.UnboundTypeError=dr(Error,"UnboundTypeError"),yn();function br(e,r,t){var n=t>0?t:ar(e)+1,i=new Array(n),s=ir(e,i,0,i.length);return r&&(i.length=s),i}var eo={q:bt,p:kt,D:St,x:Rt,t:Ot,F:Nt,u:dn,r:pn,d:vn,E:wn,l:En,c:Pn,b:kn,k:Cn,g:Dn,o:Tn,f:An,i:Rn,n:Kr,m:Mn,a:Nn,w:Un,B:Vn,v:Bn,z:Hn,A:xn,j:Wn,y:Gn,C:Xn,s:Kn,h:Qn,e:Zn};Et(),a.___wasm_call_ctors=function(){return(a.___wasm_call_ctors=a.asm.H).apply(null,arguments)};var tr=a._malloc=function(){return(tr=a._malloc=a.asm.I).apply(null,arguments)},le=a._free=function(){return(le=a._free=a.asm.K).apply(null,arguments)},Zr=a.___errno_location=function(){return(Zr=a.___errno_location=a.asm.L).apply(null,arguments)},et=a.___getTypeName=function(){return(et=a.___getTypeName=a.asm.M).apply(null,arguments)};a.___embind_register_native_and_builtin_types=function(){return(a.___embind_register_native_and_builtin_types=a.asm.N).apply(null,arguments)};var rt=a._emscripten_builtin_memalign=function(){return(rt=a._emscripten_builtin_memalign=a.asm.O).apply(null,arguments)},tt=a.___cxa_is_pointer_type=function(){return(tt=a.___cxa_is_pointer_type=a.asm.P).apply(null,arguments)};a.dynCall_viiijj=function(){return(a.dynCall_viiijj=a.asm.Q).apply(null,arguments)},a.dynCall_jij=function(){return(a.dynCall_jij=a.asm.R).apply(null,arguments)},a.dynCall_jii=function(){return(a.dynCall_jii=a.asm.S).apply(null,arguments)},a.dynCall_jiji=function(){return(a.dynCall_jiji=a.asm.T).apply(null,arguments)};var nr;function ro(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}Fe=function e(){nr||Pr(),nr||(Fe=e)};function Pr(e){if(ye>0||(ht(),ye>0))return;function r(){nr||(nr=!0,a.calledRun=!0,!he&&(pt(),d(a),a.onRuntimeInitialized&&a.onRuntimeInitialized(),vt()))}a.setStatus?(a.setStatus("Running..."),setTimeout(function(){setTimeout(function(){a.setStatus("")},1),r()},1)):r()}if(a.run=Pr,a.preInit)for(typeof a.preInit=="function"&&(a.preInit=[a.preInit]);a.preInit.length>0;)a.preInit.pop()();return Pr(),a.ready}})(),Do=Object.defineProperty,To=Object.getOwnPropertyDescriptor,Be=(y,_,a,d)=>{for(var p=d>1?void 0:d?To(_,a):_,b=y.length-1,k;b>=0;b--)(k=y[b])&&(p=(d?k(_,a,p):k(p))||p);return d&&p&&Do(_,a,p),p};class Le extends ne{constructor(){super(...arguments);F(this,"decoder");F(this,"config");F(this,"module");F(this,"sampleRate",0);F(this,"channels",0)}initialize(){return new Promise(a=>{const d={};d.print=p=>console.log(p),d.printErr=p=>console.log(`[JS] ERROR: ${p}`),d.onAbort=()=>console.log("[JS] FATAL: WASM ABORTED"),d.postRun=p=>{this.module=p,this.decoder=new this.module.AudioDecoder(this),a()},console.log("audio soft decoder initialize call"),Co(d)})}configure(a){this.config=a,this.decoder.setCodec(this.config.codec,this.config.description)}decode(a){this.decoder.decode(a.data,a.timestamp)}flush(){}reset(){this.config=void 0,this.decoder&&this.decoder.clear()}close(){this.removeAllListeners(),this.decoder&&(this.decoder.clear(),this.decoder.delete())}audioInfo(a,d){this.sampleRate=a,this.channels=d;let p={sampleRate:a,channels:d,depth:16};this.emit(me.AudioCodecInfo,p)}pcmData(a,d,p){if(!this.module)return;let b=[];for(let J=0;J<this.channels;J++){let V=this.module.HEAPU32[(a>>2)+J]>>2;b.push(Float32Array.of(...this.module.HEAPF32.subarray(V,V+d)))}let k={datas:b,sampleNum:d,channles:this.channels,pts:p};this.emit(me.AudioFrame,k)}errorInfo(a){let d={errMsg:a};this.emit(me.Error,d)}}Be([x(ne.INIT,"initialized")],Le.prototype,"initialize",1);Be([x("initialized","configured")],Le.prototype,"configure",1);Be([or("configured")],Le.prototype,"decode",1);Be([x("configured","initialized")],Le.prototype,"reset",1);Be([x([],"closed")],Le.prototype,"close",1);var Ao=Object.defineProperty,Fo=Object.getOwnPropertyDescriptor,He=(y,_,a,d)=>{for(var p=d>1?void 0:d?Fo(_,a):_,b=y.length-1,k;b>=0;b--)(k=y[b])&&(p=(d?k(_,a,p):k(p))||p);return d&&p&&Ao(_,a,p),p};class Ae extends ne{constructor(){super(...arguments);F(this,"decoder");F(this,"config")}async initialize(){this.decoder=new AudioDecoder({output:a=>{this.emit(me.AudioFrame,a)},error:a=>{this.emit(me.Error,a),this.close()}})}configure(a){this.config=a,console.log("configure",a),this.decoder.configure({codec:{aac:"mp4a.40.2",pcma:"alaw",pcmu:"ulaw"}[a.codec],description:a.description,sampleRate:a.sampleRate,numberOfChannels:a.numberOfChannels})}decode(a){this.decoder.state==="configured"&&this.decoder.decode(new EncodedAudioChunk(a))}flush(){this.decoder.flush()}reset(){this.decoder.reset()}close(){this.decoder.close()}}He([x([ne.INIT,"closed"],"initialized")],Ae.prototype,"initialize",1);He([x("initialized","configured")],Ae.prototype,"configure",1);He([or("configured")],Ae.prototype,"decode",1);He([x([],ne.INIT)],Ae.prototype,"reset",1);He([x([],"closed",{ignoreError:!0})],Ae.prototype,"close",1);const So={key:0},Ro=Vue.createTextVNode("  "),Oo={key:1,class:"video-container"},$o=Vue.defineComponent({__name:"index",setup(y){let _,a;const d=Vue.reactive({}),{params:p}=oo(),b=ao(),k=Vue.ref(!1),J=Vue.ref(9),V=Vue.ref(0),ie=Vue.ref(0);b.getConfig(p.id,"WebRTC").catch(W=>{k.value=!0});const R=new co("m7s/webrtc/batch",{requestInit:{headers:{m7sid:p.id}}}),Z=R.webrtc;async function ee(W){const S=JSON.parse(W.data);if(!S.Streams)return;ie.value=S.Streams.length;const te=S.Streams.sort((M,G)=>M.Path.localeCompare(G.Path)).slice(V.value*J.value,(V.value+1)*J.value),B=[];for(const M of te)d[M.Path]||(d[M.Path]=new fo(M.Path),R.addStream(d[M.Path]),B.push(M.Path));if(B.length>0){const M=await Z.createOffer();await Z.setLocalDescription(M),_.send(JSON.stringify({type:"subscribe",offer:M.sdp,streamList:B}))}}return io(()=>a==null?void 0:a.close()),Vue.onMounted(async()=>{_=Z.createDataChannel("signal"),_.onmessage=async W=>{console.log(W);const S=JSON.parse(W.data);switch(S.type){case"answer":console.log(S.sdp),Z.setRemoteDescription(new RTCSessionDescription(S));break;case"remove":console.log("remove",S.streamPath),R.deleteStream(S.streamPath),delete d[S.streamPath];break;case"offer":await Z.setRemoteDescription(new RTCSessionDescription(S));const z=await Z.createAnswer();await Z.setLocalDescription(z),_.send(JSON.stringify(z))}},_.onopen=async()=>{a=new EventSource("/api/summary?m7sid="+p.id),a.onmessage=ee},Z.ondatachannel=async W=>{const S=W.channel;console.log("ondatachannel",W);const z=d[S.label];if(z){let te,B;const M=new lo(S),G=new _o(M,Ne.PUSH);G.gotVideo=O=>de.decode(O),G.gotAudio=O=>re.decode(O);const de=new Te,re=new Ae;await de.initialize(),await re.initialize(),G.on(je.VIDEO_ENCODER_CONFIG_CHANGED,O=>{console.log("VIDEO_ENCODER_CONFIG_CHANGED",O),de.configure(O)}),G.on(je.AUDIO_ENCODER_CONFIG_CHANGED,O=>{console.log("AUDIO_ENCODER_CONFIG_CHANGED",O),re.configure(O)}),de.on(ve.Error,O=>{console.error(O),de.initialize()}),de.on(ve.VideoFrame,O=>{if(!z.videoTrack){const he=new MediaStreamTrackGenerator({kind:"video"});z.videoTrack=he,te=he.writable.getWriter()}te.write(O)}),re.on(me.Error,O=>{console.error(O),re.initialize()}),re.on(me.AudioFrame,O=>{if(!z.audioTrack){const he=new MediaStreamTrackGenerator({kind:"audio"});z.audioTrack=he,B=he.writable.getWriter()}B.write(O)}),M.connect()}},R.connect()}),(W,S)=>{const z=Vue.resolveComponent("n-alert"),te=Vue.resolveComponent("n-pagination");return k.value?(Vue.openBlock(),Vue.createElementBlock("div",So,[Vue.createVNode(z,{title:"",type:"error"},{default:Vue.withCtx(()=>[Ro]),_:1})])):(Vue.openBlock(),Vue.createElementBlock("div",Oo,[(Vue.openBlock(!0),Vue.createElementBlock(Vue.Fragment,null,Vue.renderList(d,B=>(Vue.openBlock(),Vue.createBlock(go,{value:B},null,8,["value"]))),256)),Vue.createVNode(te,{"show-size-picker":"","page-sizes":[4,9,16,25],page:V.value,"onUpdate:page":S[0]||(S[0]=B=>V.value=B),"item-count":ie.value,"page-size":J.value,"onUpdate:page-size":S[1]||(S[1]=B=>J.value=B)},null,8,["page","item-count","page-size"])]))}}}),Bo=nt($o,[["__scopeId","data-v-db83052c"]]);export{Bo as default};
